#include "tb_driver.h"

void tb_driver::generate_input(void){
	//это входные матрицы изображения и кернела
	//нормализация кернела- деление каждого элемента кернела на сумму его элементов
   sc_int<16> A[KER]= { -3,-2,-1,1 ,2,3,4,-5,6 };
   sc_int<16> B_NORMAL[IMG]={ 0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,       100,       128,       128,       128,       100,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        33,        91,        91,        91,       148,       164,       164,       196,       200,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,        35,        55,       107,       200,       200,       200,        43,         0,         0,        72,       157,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,        14,       170,       246,       152,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,       186,       249,       137,        12,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,        14,       186,       243,       126,        27,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,        18,       237,       126,        33,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,        18,       237,        55,         0,        64,       128,       128,       128,       128,       128,        46,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,        18,       237,        55,        59,       173,       222,       164,       164,       164,       235,       150,        91,        91,        71,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,        18,       237,        98,       148,       200,       129,         0,         0,         0,       157,       200,       200,       200,       169,        55,        55,        12,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,        18,       237,       241,        85,         0,         0,         0,         0,         0,         0,         0,         0,         0,        51,       238,       254,        55,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,        18,       237,        69,         6,         0,         0,         0,         0,         0,         0,         0,         0,         0,         4,        35,       238,        55,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,        18,       237,       212,        72,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        18,       237,        55,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         6,        85,       220,       196,        82,         0,         0,         0,         0,         0,         0,         0,         0,         0,        18,       237,        55,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,       100,       210,       128,         0,         0,         0,         0,         0,         0,         0,         0,        28,       137,       246,        55,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,       164,       173,        59,         0,         0,         0,         0,         0,         0,        33,       126,       249,       170,        35,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,       129,       228,       183,        43,         0,         0,         0,        35,        55,       126,       243,       186,        14,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,       119,       243,       204,        18,        18,        18,       170,       246,       237,       186,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         9,       103,       251,       237,       237,       237,       249,       137,        18,        14,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        19,        55,        55,        55,        55,        55,        27,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,

};
   //пока что подаём транспонированное изображение чтобы не транспонировать в conv
   sc_int<16> B_TRANSPOSED[IMG] = { 0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,        14,        18,        18,        18,        18,        18,        18,        18,         6,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,       186,       237,       237,       237,       237,       237,       237,       237,        85,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,        14,       186,       243,       126,        55,        55,        98,       241,        69,       212,       220,       100,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,        35,       170,       249,       126,        33,         0,        59,       148,        85,         6,        72,       196,       210,       164,       129,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,        55,       246,       137,        27,         0,        64,       173,       200,         0,         0,         0,        82,       128,       173,       228,       119,         9,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,        33,       107,       152,        12,         0,         0,       128,       222,       129,         0,         0,         0,         0,         0,        59,       183,       243,       103,        19,         0,         0,         0,         0,         0,
         0,         0,         0,         0,        91,       200,         0,         0,         0,         0,       128,       164,         0,         0,         0,         0,         0,         0,         0,        43,       204,       251,        55,         0,         0,         0,         0,         0,
         0,         0,         0,         0,        91,       200,         0,         0,         0,         0,       128,       164,         0,         0,         0,         0,         0,         0,         0,         0,        18,       237,        55,         0,         0,         0,         0,         0,
         0,         0,         0,         0,        91,       200,         0,         0,         0,         0,       128,       164,         0,         0,         0,         0,         0,         0,         0,         0,        18,       237,        55,         0,         0,         0,         0,         0,
         0,         0,         0,       100,       148,        43,         0,         0,         0,         0,       128,       235,       157,         0,         0,         0,         0,         0,         0,         0,        18,       237,        55,         0,         0,         0,         0,         0,
         0,         0,         0,       128,       164,         0,         0,         0,         0,         0,        46,       150,       200,         0,         0,         0,         0,         0,         0,        35,       170,       249,        55,         0,         0,         0,         0,         0,
         0,         0,         0,       128,       164,         0,         0,         0,         0,         0,         0,        91,       200,         0,         0,         0,         0,         0,         0,        55,       246,       137,        27,         0,         0,         0,         0,         0,
         0,         0,         0,       128,       196,        72,         0,         0,         0,         0,         0,        91,       200,         0,         0,         0,         0,         0,        33,       126,       237,        18,         0,         0,         0,         0,         0,         0,
         0,         0,         0,       100,       200,       157,         0,         0,         0,         0,         0,        71,       169,        51,         4,         0,         0,        28,       126,       243,       186,        14,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        55,       238,        35,        18,        18,       137,       249,       186,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        55,       254,       238,       237,       237,       246,       170,        14,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        12,        55,        55,        55,        55,        55,        35,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
};
     for (int j = 0; j < KER; ++j) {
         kernel[j].write(A[j]);                 
     }

     for (int i = 0; i < IMG; ++i) {
         image[i].write(B_TRANSPOSED[i]);
     }
};

void tb_driver::generate_reset(void) {
        rst_n.write(1);
        wait(1, SC_NS);
        rst_n.write(0);
        wait(1, SC_NS);
        rst_n.write(1);
    };