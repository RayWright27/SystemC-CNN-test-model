#include "tb_driver.h"

void tb_driver::generate_input(void){
	//это входные матрицы изображения и кернела
	//нормализация кернела- деление каждого элемента кернела на сумму его элементов
    const sc_int<16> A[M1][N1] = { 1,0,0,-1 ,5,0,0,-1,0};
		const sc_int<16> B[M2][N2]={0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000, 100.00000, 128.00000, 128.00000, 128.00000, 100.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,  33.00000,  91.00000,  91.00000,  91.00000, 148.00000, 164.00000, 164.00000, 196.00000, 200.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,  35.00000,  55.00000, 107.00000, 200.00000, 200.00000, 200.00000,  43.00000,   0.00000,   0.00000,  72.00000, 157.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,  14.00000, 170.00000, 246.00000, 152.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000, 186.00000, 249.00000, 137.00000,  12.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,  14.00000, 186.00000, 243.00000, 126.00000,  27.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,  18.00000, 237.00000, 126.00000,  33.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,  18.00000, 237.00000,  55.00000,   0.00000,  64.00000, 128.00000, 128.00000, 128.00000, 128.00000, 128.00000,  46.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,  18.00000, 237.00000,  55.00000,  59.00000, 173.00000, 222.00000, 164.00000, 164.00000, 164.00000, 235.00000, 150.00000,  91.00000,  91.00000,  71.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,  18.00000, 237.00000,  98.00000, 148.00000, 200.00000, 129.00000,   0.00000,   0.00000,   0.00000, 157.00000, 200.00000, 200.00000, 200.00000, 169.00000,  55.00000,  55.00000,  12.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,  18.00000, 237.00000, 241.00000,  85.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,  51.00000, 238.00000, 254.00000,  55.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,  18.00000, 237.00000,  69.00000,   6.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   4.00000,  35.00000, 238.00000,  55.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,  18.00000, 237.00000, 212.00000,  72.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,  18.00000, 237.00000,  55.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   6.00000,  85.00000, 220.00000, 196.00000,  82.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,  18.00000, 237.00000,  55.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000, 100.00000, 210.00000, 128.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,  28.00000, 137.00000, 246.00000,  55.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000, 164.00000, 173.00000,  59.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,  33.00000, 126.00000, 249.00000, 170.00000,  35.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000, 129.00000, 228.00000, 183.00000,  43.00000,   0.00000,   0.00000,   0.00000,  35.00000,  55.00000, 126.00000, 243.00000, 186.00000,  14.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000, 119.00000, 243.00000, 204.00000,  18.00000,  18.00000,  18.00000, 170.00000, 246.00000, 237.00000, 186.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   9.00000, 103.00000, 251.00000, 237.00000, 237.00000, 237.00000, 249.00000, 137.00000,  18.00000,  14.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,  19.00000,  55.00000,  55.00000,  55.00000,  55.00000,  55.00000,  27.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,   0.00000,
};
         for (int i = 0; i < M1; ++i) {
            for (int k = 0; k < N1; ++k) {
                kernel[i][k].write(A[i][k]);
            }
        }
        for (int k = 0; k < M2; ++k) {
            for (int j = 0; j < N2; ++j) {
                image[k][j].write(B[k][j]);
            }
        }
};

void tb_driver::generate_reset(void) {
        rst_n.write(1);
        wait(1, SC_NS);
        rst_n.write(0);
        wait(1, SC_NS);
        rst_n.write(1);
    };