#include "tb_driver.h"

void tb_driver::generate_input(void) {
    //это входные матрицы изображения и кернела
    //нормализация кернела- деление каждого элемента кернела на сумму его элементов
    sc_int<16> A[L1][M1][N1] = { 1,0,0,-1 ,5,0,0,-1,0 };
    sc_int<16> B[M2][N2] = { 0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,       100,       128,       128,       128,       100,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        33,        91,        91,        91,       148,       164,       164,       196,       200,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         0,         0,         0,        35,        55,       107,       200,       200,       200,        43,         0,         0,        72,       157,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         0,         0,        14,       170,       246,       152,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         0,         0,       186,       249,       137,        12,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,        14,       186,       243,       126,        27,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,        18,       237,       126,        33,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,        18,       237,        55,         0,        64,       128,       128,       128,       128,       128,        46,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,        18,       237,        55,        59,       173,       222,       164,       164,       164,       235,       150,        91,        91,        71,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,        18,       237,        98,       148,       200,       129,         0,         0,         0,       157,       200,       200,       200,       169,        55,        55,        12,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,        18,       237,       241,        85,         0,         0,         0,         0,         0,         0,         0,         0,         0,        51,       238,       254,        55,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,        18,       237,        69,         6,         0,         0,         0,         0,         0,         0,         0,         0,         0,         4,        35,       238,        55,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,        18,       237,       212,        72,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        18,       237,        55,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         6,        85,       220,       196,        82,         0,         0,         0,         0,         0,         0,         0,         0,         0,        18,       237,        55,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         0,         0,       100,       210,       128,         0,         0,         0,         0,         0,         0,         0,         0,        28,       137,       246,        55,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         0,         0,         0,       164,       173,        59,         0,         0,         0,         0,         0,         0,        33,       126,       249,       170,        35,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         0,         0,         0,       129,       228,       183,        43,         0,         0,         0,        35,        55,       126,       243,       186,        14,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,       119,       243,       204,        18,        18,        18,       170,       246,       237,       186,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         9,       103,       251,       237,       237,       237,       249,       137,        18,        14,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,        19,        55,        55,        55,        55,        55,        27,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,
        0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,         0,

    };
    sc_int<DT_LENGTH> TEST[KER] = { 0 };
     for (int j = 0; j < L1; ++j) {
         for (int i = 0; i < M1; ++i) {
            for (int k = 0; k < N1; ++k) {
                    kernel[j * M1 * N1 + i * M1 + k].write(A[j][i][k]);
            }
         }
     }
     
     cout << endl;
     for (int i = 0; i < M2; ++i) {
        for (int k = 0; k < N2; ++k) {
                image[i*N2+k].write(B[i][k]);
        }
     }
    
};

void tb_driver::generate_reset(void) {
        rst_n.write(1);
        wait(1, SC_NS);
        rst_n.write(0);
        wait(10, SC_NS);
        rst_n.write(1);
    };